#!/bin/bash

# forester is for when you have multiple branches off develop and you want to see where you stand amongst them
#
# how many days back?
DAYS=${1:-"3"}

# what branches do you want to grab recent logs from?
BRANCH_PREFIX=${2:-"feature"}
OUTFILE=${3:-"/tmp/forester.txt"}

echo "see forest for trees"
# fail if outside a git repository
git branch || { echo "you must be in a repository" ; exit 1 ;}

ARGS="$(git branch | cut -c'3-' | grep "^$BRANCH_PREFIX" | xargs)"

if [ ${#ARGS} == 0 ]; then
{ echo "No branches matching $BRANCH_PREFIX" ; exit 1 ;}
fi

printline()
{
    echo
    printhrule $i
    echo $i
    printhrule $i
    echo
    git log --stat --pretty=oneline --since=${DAYS}days $1
}

printhrule()
{
    for j in `seq 1 ${#1}`
    do
        echo -n =
    done
    # adds a libe break
    echo 
}

for i in ${ARGS[@]}
do
    printline $i >> $OUTFILE    
done

